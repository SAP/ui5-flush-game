sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/m/MessageToast","sap/ui/Device"],function(e,t,s,i){"use strict";sap.m.MessageToast._validateDockPosition=function(){};var a=0;return t.extend("flush.game.controls.MessageToastDeluxe",{metadata:{properties:{image:{type:"string"},position:{type:"string",defaultValue:"left top"},duration:{type:"int",defaultValue:3e3},width:{type:"sap.ui.core.CSSSize",defaultValue:"15em"},message:{type:"string",defaultValue:""},number:{type:"string",defaultValue:""},jitter:{type:"int",defaultValue:0},quote:{type:"boolean",defaultValue:false},speaker:{type:"string",defaultValue:""}}},init:function(){this._EFFECT_DEFAULT_SIZE=200;this._MAX_GAME_HEIGHT=770;this._MESSAGETOAST_WIDTH=288;this._HEADER_HEIGHT=50;this._fallbackSizes={"flush_logo_large.png":[427,179],"flush_logo_xl.png":[909,332],"effect_awesome.png":[381,271],"effect_ha_ha_ha_neu.png":[344,259],"effect_ohno.png":[234,236],"effect_plop.png":[250,256],"effect_points.png":[200,167],"effect_points_critical.png":[200,167],"effect_points_negative.png":[200,167],"effect_pow.png":[300,138],"effect_lowenergy.png":[200,160],"Boom.png":[400,179],"Zing.png":[400,299],"GodMode.png":[839,391],"BlauZaehne.png":[162,191],"GrauKeineMeinung.png":[162,191],"GruenHoffnungsvoll.png":[162,191],"LilaDebatiert.png":[162,191],"OrangeBefuerchtet.png":[162,191],"RotRenderManagerDroht.png":[162,191]}},_getFallbackSize:function(e){if(this._fallbackSizes[e]){return this._fallbackSizes[e]}else{return[this._EFFECT_DEFAULT_SIZE,this._EFFECT_DEFAULT_SIZE]}},_sneakInImage:function(){var e=document.getElementsByClassName("sapMMessageToast"),t=e.item(e.length-1),s=this._getFallbackSize(this.getImage());var a=document.createElement("img");a.setAttribute("src",sap.ui.require.toUrl("flush/game/images")+"/"+this.getImage());a.classList.add("messageToastDeluxeImage");if(i.resize.width<s[0]){var n=s[0];s[0]=i.resize.width*.9;s[1]=s[1]*s[0]/n}else if(i.resize.height<s[1]){var n=s[1];s[1]=Math.min(i.resize.height*.9,this._MAX_GAME_HEIGHT);s[0]=s[1]*s[0]/n}a.width=s[0];a.height=s[1];if(this.getMessage()){a.style.left=(t.offsetWidth-(a.width||s[0]))/2+"px";a.style.bottom=t.offsetHeight+"px"}else{var g=(a.height||s[1])/-2-this._HEADER_HEIGHT;if(this.getPosition().split(" ").pop()==="bottom"){g/=2}a.style.left=(a.width||s[0])/-2+"px";a.style.bottom=g+"px"}t.appendChild(a)},_sneakInNumber:function(){var t=document.getElementsByClassName("sapMMessageToast"),s=t.item(t.length-1),i=this._getFallbackSize(this.getImage()),a=s.getElementsByTagName("img")[0];var n=document.createElement("span");n.classList.add("messageToastDeluxeNumber");if(this.getNumber()<0){n.classList.add("negative")}n.appendChild(document.createTextNode(this.getNumber()));n.style.left=(a.width||i[0])/-2+"px";n.style.bottom=-30-this._HEADER_HEIGHT+"px";s.appendChild(n);e(s).animate({top:"-=200"})},show:function(){return new Promise(function(e,t){if(this.getMessage()||this.getImage()){var n=this.getMessage();if(this.getQuote()){n='"'+n+'"'}if(this.getSpeaker()){n=this.getSpeaker()+": "+n}var g=this.getWidth();if(!this.getMessage()){g="0"}var l=this.getPosition();var h=0;if(this.getParent()&&this.getParent().getParent()&&this.getParent().getParent().$().offset()){h=this.getParent().getParent().$().offset().left;a=h}else if(a){h=a}var o=-64;var r=l.split(" ");if(r[0]==="end"||r==="right"){h*=-1}else if(r[0]==="left"||r[0]==="begin"){}else if(r[0]==="center"){h=0}else{h+=parseInt(r[0]);l="begin top"}if(r[1]==="top"){o*=-2}else if(r[1]==="center"){o*=-1}else if(r[1]==="bottom"){}else{l="begin top";o=parseInt(r[1])}var f=document.getElementsByClassName("flush")[0].getBoundingClientRect().left||16;if(f>this._MESSAGETOAST_WIDTH/2){f-=this._MESSAGETOAST_WIDTH/2}if(typeof r[0]==="string"||typeof r[1]==="string"){if(r[0]==="begin"){r[0]=f}else if(r[0]==="center"){r[0]=i.resize.width/2-(this.getMessage()?this._MESSAGETOAST_WIDTH/2:0)}else if(r[0]==="end"){r[0]=i.resize.width-this._MESSAGETOAST_WIDTH-f}else{r[0]=parseInt(r[0]);r[0]+=document.getElementsByClassName("game")[0].getClientRects()[0].left}if(r[1]==="top"){r[1]=0}else if(r[1]==="center"){r[1]=Math.min(i.resize.height,this._MAX_GAME_HEIGHT)/2}else if(r[1]==="bottom"){r[1]=Math.min(i.resize.height,this._MAX_GAME_HEIGHT)-100}else{r[1]=parseInt(r[1])}if(this.getMessage()&&this.getImage()){r[1]+=this._HEADER_HEIGHT}else{r[1]-=this._HEADER_HEIGHT/2}l={left:r[0],top:r[1]}}if(this.getJitter()){h+=Math.floor(Math.abs(Math.random())*this.getJitter());o+=Math.floor(Math.abs(Math.random())*this.getJitter()/2)}s.show(n,{at:l,duration:this.getDuration(),width:g,onClose:e});var p=document.getElementsByClassName("sapMMessageToast"),u=p.item(p.length-1);u.classList.add("flush");if(!this.getMessage()){u.classList.add("transparent")}if(this.getImage()){this._sneakInImage()}if(this.getNumber()){this._sneakInNumber()}}else{setTimeout(function(){e()},this.getDuration())}}.bind(this))}})});